#Attempt to Get Revenue in R
install.packages("readxl")
install.packages("tidyr")
install.packages("dplyr")
install.packages("did")
install.packages("tidyverse")
install.packages("lmtest")
library(readxl)
library(tidyr)
library(dplyr)
library(did)
library(tidyverse)
library(lmtest)
Census State and Local Data- Tax Foundation
# Census State and Local Data- Tax Foundation
install.packages("readxl")
install.packages("tidyr")
install.packages("dplyr")
install.packages("tidyverse")
install.packages("xlsx")
library(readxl)
library(tidyr)
library(dplyr)
library(tidyverse)
library(xlsx)
#Nebraska or "Direct Switchers DiD Approach"
#Run DiD with all the Direct Switchers (NE, MO, MS, CO, RI, ND, DE)
#Control Group is all States that Did not Switch by 2007.
#this includes: AK, HI, KS, NM, OK.  AL and MT between 2008-now became "Step
#-wise" switchers.  FL and MA had DWS over the whole period 1976-2022.
library(tidyr)
library(dplyr)
library(tidyverse)
# for robust standard error estimation
library(lmtest)
# To calculate correct vcov matrix with 2WFE
library(multiwayvcov)
# For a package way to do FE
library(plm)
#Fixest
install.packages("fixest")
library(fixest)
#Load Data Tables in R
install.packages("data.table")
# Get rate of change for tax bases and find elasticity of tax base w.r.t apportionment and rate changes.
#Redo Callaway and Sant'Anna From Summer
library(readxl)
library(tidyr)
library(dplyr)
library(did)
library(tidyverse)
library(lmtest)
library(caret)
library(ggplot2)
#New Directory
setwd("~/Documents/GitHub/ST_Apportionment/Rates_Of_Change")
#Elasticity Results for All the Tax Bases
library(readxl)
library(tidyr)
library(dplyr)
library(tidyverse)
library(lmtest)
library(caret)
library(ggplot2)
#JMP Directory
setwd("~/Documents/GitHub/ST-Apportionment/job_market_data")
#Load data for Elasticity JMP
Elas <-read.csv("elasticity_data_jmp.csv")
#Load data for Elasticity JMP
Elas <-read.csv("elasticity_rates_jmp.csv")
View(Elas)
#remove the X column
Elas <-Elas %>%
select(-X)
#save without X column
write.csv(Elas,"elasticity_rates_jmp.csv")
fitted_models = Elas %>% group_by(state) %>% do(model = lm(CORPINCTX ~ sales, data = Elas))
View(fitted_models)
fitted_models$model
fitted_models %>% tidy(model)
library(broom) #for tidying up the group by regressions
fitted_models %>% tidy(model)
install.packages("broom")
install.packages("broom")
library(broom) #for tidying up the group by regressions
#Elasticity Results for All the Tax Bases
library(readxl)
library(tidyr)
library(dplyr)
library(tidyverse)
library(lmtest)
library(caret)
library(ggplot2)
fitted_models %>% tidy(model)
fitted_models = Elas %>% group_by(state) %>% do(model = lm(CORPINCTX ~ sales, data = Elas))
fitted_models$model
fitted_models %>% tidy(model)
#check data type of Elas
str(Elas)
Elas_numeric <- Elas
# Convert integer columns to numeric in the new data frame
Elas_numeric$BUSLICTAX <- as.numeric(Elas_numeric$BUSLICTAX)
Elas_numeric$CORPINCTX <- as.numeric(Elas_numeric$CORPINCTX)
Elas_numeric$CORPLICTAX <- as.numeric(Elas_numeric$CORPLICTAX)
Elas_numeric$PROPTAX <- as.numeric(Elas_numeric$PROPTAX)
Elas_numeric$SLGRTAX <- as.numeric(Elas_numeric$SLGRTAX)
Elas_numeric$SVRNCTAX <- as.numeric(Elas_numeric$SVRNCTAX)
Elas_numeric$TLINCTAX <- as.numeric(Elas_numeric$TLINCTAX)
Elas_numeric$TLSLTAX <- as.numeric(Elas_numeric$TLSLTAX)
Elas_numeric$TOTLTAX <- as.numeric(Elas_numeric$TOTLTAX)
Elas_numeric$INCTAX <- as.numeric(Elas_numeric$INCTAX)
Elas_numeric$SALESTAX <- as.numeric(Elas_numeric$SALESTAX)
#check it
str(Elas_numeric)
#save without X column and numeric tax collections
write.csv(Elas_numeric,"elasticity_rates_jmp.csv")
fitted_models = Elas_numeric %>% group_by(state) %>% do(model = lm(CORPINCTX ~ sales, data = .))
View(Elas_numeric)
#Some items are missing in the regression:
Elas_numeric %>%
group_by(state) %>%
summarize(
n_missing_CORPINCTX = sum(is.na(CORPINCTX)),
n_missing_sales = sum(is.na(sales))
)
Print(n=...)
print(n=...)
print(n=...)
`print(n = ...)`
missing_values <- Elas_numeric %>%
filter(is.na(CORPINCTX)) %>%
select(state, CORPINCTX, sales)
# View the data frame
missing_values
View(missing_values)
#Find the missing values
missing_values <- Elas_numeric %>%
filter(is.na(CORPINCTX)) %>%
select(state, CORPINCTX, sales,year)
View(missing_values)
#Create new dataframe
Elas_numeric2 <- Elas_numeric %>%
filter(!is.na(CORPINCTX))
write.csv(Elas_numeric2,"elasticity_rates_jmp.csv")
View(Elas_numeric2)
fitted_models = Elas_numeric2 %>% group_by(state) %>% do(model = lm(CORPINCTX ~ sales, data = .))
fitted_models$model
fitted_models %>% tidy(model)
#Could not estimate a simple result, because there isn't enough variation in the sales factor.
#therefore, will try simple non-log result with fixed effects
#(ii) CITrev ~ state + factor(year) + sales + rates + E
fitted_models = Elas_numeric2 %>% group_by(state) %>% do(model = lm(CORPINCTX ~ state+factor(year)+sales+rates, data = .))
#Could not estimate a simple result, because there isn't enough variation in the sales factor.
#therefore, will try simple non-log result with fixed effects
#(ii) CITrev ~ state + factor(year) + sales + rates + E
fitted_models = Elas_numeric2 %>% group_by(state) %>% do(model = lm(CORPINCTX ~ state + factor(year) + sales + rates, data = .))
