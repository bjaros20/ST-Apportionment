#Attempt to Get Revenue in R
install.packages("readxl")
install.packages("tidyr")
install.packages("dplyr")
install.packages("did")
install.packages("tidyverse")
install.packages("lmtest")
library(readxl)
library(tidyr)
library(dplyr)
library(did)
library(tidyverse)
library(lmtest)
Census State and Local Data- Tax Foundation
# Census State and Local Data- Tax Foundation
install.packages("readxl")
install.packages("tidyr")
install.packages("dplyr")
install.packages("tidyverse")
install.packages("xlsx")
library(readxl)
library(tidyr)
library(dplyr)
library(tidyverse)
library(xlsx)
#set working directory
setwd("~/Documents/SSFA Directory")
install.packages("tidyr")
install.packages("dplyr")
install.packages("tidyverse")
library(tidyr)
library(dplyr)
library(tidyverse)
Giroud <- read_csv("Giroud.csv")
View(Giroud)
ls(SSFA Directory)
#set working directory
setwd("~/Documents/GitHub/ST-Apportionment")
Giroud <- read_csv("Giroud.csv")
My_app <-read_builtin("SalesFactor_Weight_BJ")
My_app <-read_csv("SalesFactor_Weight_BJ")
My_app <-read_csv("SalesFactor_Weight_BJ.csv")
View(Giroud)
View(My_app)
filter(My_app, year(1985-2023))
filter(My_app, year(1985))
App_clean <- My_app %>% filter(Year >=1985,Year <=2023)
View(App_clean)
View(Giroud)
View(App_clean)
Num_app <- App_clean %>%
mutate(across(-Year,~,*100))
Num_app <- App_clean %>%
mutate(across(-Year,~.*100))
Num_app <- App_clean %>%
mutate(across(-Year,~ifelse(is.numeric(.),.*100,.)))
View(Num_app)
#check Alabama Column
is.numeric(Num_app$Alabama)
transform(Num_app,Alabama=as.numeric(Alabama) )
#check Alabama Column
is.numeric(Num_app$Alabama)
Num_App2 <-transform(Num_app,Alabama=as.numeric(Alabama))
is.numeric(Num_app2$Alabama)
is.numeric(Num_App2$Alabama)
Num_App2$Alabama <- Num_App2$Alabama * 100
View(Num_App2)
View(My_app)
View(App_clean)
View(Num_app)
#Convert All Columns to Numeric
App_Num <-lapply(App_Num,as.numeric)
#Convert All Columns to Numeric
App_Num <-lapply(App_clean,as.numeric)
View(App_Num)
str(App_Num)
App_cleanNum <- App_clean %>% mutate_if(is.character, as.numeric)
View(App_cleanNum)
Num_App3 <- App_cleanNum %>%
mutate(across(!Year,.*100))
Num_App3 <- App_cleanNum %>%
mutate(across(!Year,.*100),.)
Num_App3 <- App_cleanNum %>%
mutate(across(!Year,.*100))
Num_App3 <- App_cleanNum %>%
mutate(across(!Year,~.*100))
View(Num_App3)
round_App <- Num_App3 %>%
mutate(across(where(is.numeric),~round(.,digits=10)))
View(round_App)
round_App <- Num_App3 %>%
mutate(across(where(is.numeric),~signif(.,digits=10)))
View(round_App)
round_App2 <-round(round_App,digits = 2)
View(round_App2)
View(Giroud)
match_round <- round_App2 %>%
mutate(across(everything(), ~ifelse(. == 33.33, 33.34, .)))
View(match_round)
write.csv(match_round,file="My_App_Wide.csv",row.names=FALSE)
Wide_app <-read_csv("My_App_Wide.csv")
View(Wide_app)
Giroud <- read_csv("Giroud.csv")
#Convert Wide to Long Panel
Long_app <- Wide_app %>%
gather(State,Value,~Year)
View(Giroud)
#Convert Wide to Long Panel
Long_app <- Wide_app %>%
pivot_longer(cols= ~Year,names_to = "State", values_to ="sales")
Long_app <- Wide_app %>%
pivot_longer(where(cols= ~Year,names_to = "State", values_to ="sales"))
Long_app <- Wide_app %>%
pivot_longer(where(cols= ~Year),names_to = "State", values_to ="sales"))
Long_app <- Wide_app %>%
pivot_longer(where(cols= ~Year),names_to = "State", values_to ="sales")
Long_app <- Wide_app %>%
pivot_longer(names_to = "State", values_to ="sales")
#Convert Wide to Long Panel
Long_app <- Wide_app %>%
pivot_longer(cols= "Alabama":"Wyoming",names_to = "State", values_to ="sales")
View(Long_app)
Long_app[order(Long_app$State),]
View(Long_app)
Long_App2 <-Long_app[order(Long_app$State),]
View(Long_App2)
#save Long panel
write.csv(Long_App2,file="My_App_Long.csv",row.names=FALSE)
#First, condense Giroud to Just Apportionment
Giroud_Just_Appt <- Giroud %>%
select(state_name,year,sales) %>%
filter(year>=1985,year <=2013)
View(Giroud_Just_Appt)
View(Giroud_Just_Appt)
View(Long_App2)
#rename state column
Giroud_Just_Appt <- Giroud_Just_Appt %>%
rename(state=state_name)
View(Giroud_Just_Appt)
#cut years after 2012 from My app
My_App_Pre13 <- Long_App2 %>%
filter(year>=1985,year<=2012)
#cut years after 2012 from My app
My_App_Pre13 <- Long_App2 %>%
filter(Year>=1985,Year <=2012)
View(My_App_Pre13)
View(Giroud_Just_Appt)
View(My_App_Pre13)
#change year columns
Pre13 <- My_App_Pre13 %>%
rename(year=Year)
#Compare Differences between Giroud and My_App_Long
differences_df <-anti_join(Giroud_Just_Appt,Pre13)
View(differences_df)
View(Pre13)
different_sales <- anti_join(Giroud_Just_Appt,Pre13, by =c("year","State"))%>%
select(year,State,sales.x,sales.y)
Pre13 <- Pre13 %>%
rename(State=state)
Pre13 <- Pre13 %>%
rename(state=State)
different_sales <- anti_join(Giroud_Just_Appt,Pre13, by =c("year","state"))%>%
select(year,state,sales.x,sales.y)
different_sales <- anti_join(Giroud_Just_Appt,Pre13, by =c("year","state"))%>%
select(year,state,sales.x=sales.x,sales.y=sales.y)
different_sales <- anti_join(Giroud_Just_Appt,Pre13, by =c("year","state"))%>%
select(year,state,sales.x=sales,sales.y=sales)
View(different_sales)
#Cut DC from Giroud
Just_States_Giroud <- Giroud_Just_Appt %>%
filter(state !="District of Columbia")
different_sales2 <- anti_join(Just_States_Giroud,Pre13, by =c("year","state"))%>%
select(year,state,sales.x=sales,sales.y=sales)
View(different_sales2)
#Trying Different Approach
different_sales2 <- Just_States_Giroud %>%
filter(!(year %in% Pre13$year & state %in% Pre13$state & sales %in% Pre13$sales))
View(different_sales2)
View(differences_df)
View(different_sales2)
View(differences_df)
View(different_sales2)
View(different_sales)
View(Just_States_Giroud)
View(Pre13)
merged_df <-merge(Just_States_Giroud,Pre13, by = c("year","state"),suffixes = c("sales.Gir","sales.MyAp"))
View(merged_df)
merged_df <-merge(Just_States_Giroud,Pre13, by = c("year","state"),suffixes = c(".Gir",".MyAp"))
View(merged_df)
#Different Sales DF
different_sales_df <- merged_df[merged_df$sales.Gir != merged_df$sales.MyAp, ]
View(different_sales_df)
rownames(different_sales_df) <- NULL
View(different_sales_df)
cleaned_Differences <-na.omit(different_sales_df)
View(cleaned_Differences)
#Sort by State
cleaned_Differences <-cleaned_Differences %>%
arrange(state)
View(cleaned_Differences)
write.csv(cleaned_Differences,file="Giroud_MyApp_differences.csv",row.names = FALSE)
write.csv(Just_States_Giroud,file="Giroud_Just_Appt_States.csv",row.names = FALSE)
write.csv(Pre13,file="My_App_Pre2013.csv",row.names=FALSE)
