gname = "year_pass_intro",
data = Rev)
# Read in DF
Rev <- read_xls("FinalGardner_AprilWorkshop24.xls")
# Read in DF
Rev <- read_xls("FinalGardner_AprilWorkshop24.xls")
# Set treatment variable and time variable
treat_var <- "year_pass_intro"
time_var <- "year"
#Another try
Rev$state <- as.numeric(factor(Rev$state))
## estimate group-time average treatment effects for Log Revenue
LogCITRev_attgt <- att_gt(yname = "Log_CORPINCTX",
tname = "year",
idname = "state",
gname = "year_pass_intro",
data = Rev)
class(year)
class(year_effective)
class(Rev2$year)
class(Rev2$year_effective)
Rev3 <- Rev2$year_effective <- as.numeric(factor(Rev$year_effective))
Rev3 <- Rev2$year_effective <- as.numeric(factor(Rev2$year_effective))
#Another try
Rev2$state <- as.numeric(factor(Rev2$state))
Rev2$year_effective <- as.numeric(factor(Rev2$year_effective))
Rev3 <- Rev2
Rev2 <- Rev2 %>%
filter(!is.na(Diff_Log_CIT))
## estimate group-time average treatment effects for Log Revenue
LogCITRev_attgt <- att_gt(yname = "Diff_Log_CIT",
tname = "year",
idname = "state",
gname = "year_effective",
data = Rev2)
View(Rev3)
View(Rev)
Rev <- Rev %>%
mutate(Rev$year_effective,is.na(Rev$year_effective),0)
View(Rev)
View(Rev)
Rev <- Rev %>%
mutate(Rev$year_effective,`Rev$year_effective`== "NA",0)
View(Rev)
class(year_effective)
class(Rev$year_effective)
Rev <- Rev %>%
mutate(Rev$year_effective,`Rev$year_effective`== NA,0)
View(Rev)
#Is.na replace
Rev[is.na(Rev)] <-0
Rev <- Rev$year_effective %>%
mutate_at(vars(where(is.character)), ~if_else(is.na(.), "", .))
Rev$year_effective[Rev$year_effective == "NA"] <- 0
View(Rev)
Rev$year_pass_intro[Rev$year_pass_intro == "NA"] <- 0
Rev$year_effective <- as.numeric(Rev$year_effective)
View(Rev)
Rev$year_pass_intro <- as.numeric(Rev$year_pass_intro)
#Create difference Column
Rev2<- Rev %>%
group_by(state) %>%
mutate(Diff_Log_CIT= Log_CORPINCTX-lag(Log_CORPINCTX))
View(Rev2)
View(Rev)
#Redo Callaway and Sant'Anna From Summer
library(readxl)
library(tidyr)
library(dplyr)
library(did)
library(tidyverse)
library(lmtest)
library(caret)
library(ggplot2)
#New Directory
setwd("~/Documents/GitHub/ST-Apportionment/Rates_Of_Change")
# Read in DF
Rev <- read_xls("FinalGardner_AprilWorkshop24.xls")
#Make CIT Log numeric
Rev$Log_CORPINCTX <- as.numeric(Rev$Log_CORPINCTX)
#replace Character NAs with 0
Rev$year_effective[Rev$year_effective == "NA"] <- 0
Rev$year_pass_intro[Rev$year_pass_intro == "NA"] <- 0
#Make Treatment Year Numeric
Rev$year_effective <- as.numeric(Rev$year_effective)
Rev$year_pass_intro <- as.numeric(Rev$year_pass_intro)
#Create difference Column
Rev2<- Rev %>%
group_by(state) %>%
mutate(Diff_Log_CIT= Log_CORPINCTX-lag(Log_CORPINCTX))
View(Rev2)
#Another try
Rev2$state <- as.numeric(factor(Rev2$state))
Rev2$year_effective <- as.numeric(factor(Rev2$year_effective))
Rev3 <- Rev2
Rev2 <- Rev2 %>%
filter(!is.na(Diff_Log_CIT))
## estimate group-time average treatment effects for Log Revenue
LogCITRev_attgt <- att_gt(yname = "Diff_Log_CIT",
tname = "year",
idname = "state",
gname = "year_effective",
data = Rev2)
View(Rev)
#Redo Callaway and Sant'Anna From Summer
library(readxl)
library(tidyr)
library(dplyr)
library(did)
library(tidyverse)
library(lmtest)
library(caret)
library(ggplot2)
#New Directory
setwd("~/Documents/GitHub/ST-Apportionment/Rates_Of_Change")
# Read in DF
Rev <- read_xls("FinalGardner_AprilWorkshop24.xls")
#Make CIT Log numeric
Rev$Log_CORPINCTX <- as.numeric(Rev$Log_CORPINCTX)
#replace Character NAs with 0
Rev$year_effective[Rev$year_effective == "NA"] <- 0
Rev$year_pass_intro[Rev$year_pass_intro == "NA"] <- 0
#Make Treatment Year Numeric
Rev$year_effective <- as.numeric(Rev$year_effective)
Rev$year_pass_intro <- as.numeric(Rev$year_pass_intro)
#Create difference Column
Rev2<- Rev %>%
group_by(state) %>%
mutate(Diff_Log_CIT= Log_CORPINCTX-lag(Log_CORPINCTX))
## estimate group-time average treatment effects for Log Revenue
LogCITRev_attgt <- att_gt(yname = "Diff_Log_CIT",
tname = "year",
idname = "state",
gname = "year_effective",
data = Rev2)
Rev2 <- Rev2 %>%
filter(!is.na(Diff_Log_CIT))
## estimate group-time average treatment effects for Log Revenue
LogCITRev_attgt <- att_gt(yname = "Diff_Log_CIT",
tname = "year",
idname = "state",
gname = "year_effective",
data = Rev2)
#Another try
Rev2$state <- as.numeric(factor(Rev2$state))
Rev2 <- Rev2 %>%
filter(!is.na(Diff_Log_CIT))
## estimate group-time average treatment effects for Log Revenue
LogCITRev_attgt <- att_gt(yname = "Diff_Log_CIT",
tname = "year",
idname = "state",
gname = "year_effective",
data = Rev2)
# summarize the results
summary(LogCITRev_attgt)
# plot the Group time Treatment for Log Revenue
ggdid(LogCITRev_attgt)
#Simple Aggregation
agg.simple <- aggte(LogCITRev_attgt, type = "simple")
summary(agg.simple)
# Dynamic Event Study Aggregation
agg.es <- aggte(LogCITRev_attgt, type = "dynamic")
summary(agg.es)
ggdid(agg.es)
ggdid_plot <- ggdid(agg.es) +
scale_x_continuous(limits = c(-10, 10))+
ggtitle("Event Study Plot (Dynamic ATT): Log CIT Revenue")+
theme(plot.title = element_text(color = "black", face = "bold", hjust = 0.5))+
geom_vline(xintercept = c(0, 1), linetype = "dashed")+
ylab("Log Dollars") +  # Label for y-axis
xlab("Year in Reference to Treatment")  # Label for x-axis
print(ggdid_plot)
# summarize the results
summary(LogCITRev_attgt)
# plot the Group time Treatment for Log Revenue
ggdid(LogCITRev_attgt)
#Simple Aggregation
agg.simple <- aggte(LogCITRev_attgt, type = "simple")
summary(agg.simple)
# Dynamic Event Study Aggregation
agg.es <- aggte(LogCITRev_attgt, type = "dynamic")
summary(agg.es)
ggdid(agg.es)
ggdid_plot <- ggdid(agg.es) +
scale_x_continuous(limits = c(-10, 10))+
ggtitle("Event Study Plot (Dynamic ATT): Log CIT Revenue")+
theme(plot.title = element_text(color = "black", face = "bold", hjust = 0.5))+
geom_vline(xintercept = c(0, 1), linetype = "dashed")+
ylab("Log Dollars") +  # Label for y-axis
xlab("Year in Reference to Treatment")  # Label for x-axis
print(ggdid_plot)
#Redo Callaway and Sant'Anna From Summer
library(readxl)
library(tidyr)
library(dplyr)
library(did)
library(tidyverse)
library(lmtest)
library(caret)
library(ggplot2)
#set working directory
setwd("~/Documents/GitHub/ST-Apportionment/Spring24_Workshop")
# Read in DF
Rev <- read_xls("FinalGardner_AprilWorkshop24.xls")
#Save new DF with Correct Values
write.csv(Rev2,"Clean_Rev_Event_4_16_24.csv")
#set working directory
setwd("~/Documents/GitHub/ST-Apportionment")
# Read in DF
Rev <- read.csv("Clean_Rev_Event_4_16_24.csv")
write.csv(average_Diff_Log_df,"Diff_Log_df_4_16_24.csv")
Diff <-read.csv("Diff_Log_df_4_16_24.csv")
Diff <-read.csv("Diff_Log_df_4_16_24.csv")
write.csv(average_Diff_Log_df,"Diff_Log.csv")
write.csv(average_Log_df,"Diff_Log_4_16_24.csv")
Diff_rev <-read.csv("Diff_Log_4_16_24.csv")
View(Diff_rev)
View(Diff)
# Create the plot with Standard Error Bars
ggplot() +
# Control Group plot
geom_point(data = Diff_rev, aes(x = year, y = average_Log_CORPINCTX_c, color = "Control Group"), size = 3) +
geom_errorbar(data = Diff_rev, aes(x = year, y = average_Log_CORPINCTX_c, ymin = average_Log_CORPINCTX_c - std_err_c, ymax = average_Log_CORPINCTX_c + std_err_c, color = "Control Group"), width = 0.2) +
geom_line(data = Diff_rev, aes(x = year, y = average_Log_CORPINCTX_c, color = "Control Group"), linetype = "dashed") +
# Additional lines from Rev2 dataframe
geom_line(data = Rev2 %>% filter(State_Aconym %in% c("NE", "CO", "RI", "DE", "ND")), aes(x = year, y = Log_CORPINCTX, color = State_Aconym)) +
labs(title = "Average Log Corporate Income Tax by Year for Control and Direct Switch States",
x = "Year",
y = "Average Log Corporate Income Tax") +
scale_color_manual(values = c("Control Group" = "blue", "NE" = "red", "CO" = "green", "RI" = "purple", "DE" = "orange", "ND" = "brown"),
labels = c("Control Group" = "Control", "NE" = "NE", "CO" = "CO", "RI" = "RI", "DE" = "DE", "ND" = "ND")) +
guides(color = guide_legend(title = "Groups")) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold")
)
ggplot() +
# Control Group plot
geom_point(data = Diff_rev, aes(x = year, y = average_Log_CORPINCTX_c, color = "Control Group"), size = 3) +
geom_errorbar(data = Diff_rev, aes(x = year, y = average_Log_CORPINCTX_c, ymin = average_Log_CORPINCTX_c - std_err_c, ymax = average_Log_CORPINCTX_c + std_err_c, color = "Control Group"), width = 0.2) +
geom_line(data = Diff_rev, aes(x = year, y = average_Log_CORPINCTX_c, color = "Control Group"), linetype = "dashed") +
# Additional lines from Rev2 dataframe
geom_line(data = Rev2 %>% filter(State_Acronym %in% c("NE", "CO", "RI", "DE", "ND")), aes(x = year, y = Log_CORPINCTX, color = State_Acronym)) +
labs(title = "Average Log Corporate Income Tax by Year for Control Group",
x = "Year",
y = "Average Log Corporate Income Tax") +
scale_color_manual(values = c("Control Group" = "blue", "NE" = "red", "CO" = "green", "RI" = "purple", "DE" = "orange", "ND" = "brown"),
labels = c("Control Group" = "Control", "NE" = "NE", "CO" = "CO", "RI" = "RI", "DE" = "DE", "ND" = "ND")) +
guides(color = guide_legend(title = "Groups")) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold")
)
#Attempt with Vertical Lines
ggplot() +
# Control Group plot
geom_point(data = Diff_rev, aes(x = year, y = average_Log_CORPINCTX_c, color = "Control Group"), size = 3) +
geom_errorbar(data = Diff_rev, aes(x = year, y = average_Log_CORPINCTX_c, ymin = average_Log_CORPINCTX_c - std_err_c, ymax = average_Log_CORPINCTX_c + std_err_c, color = "Control Group"), width = 0.2) +
geom_line(data = Diff_rev, aes(x = year, y = average_Log_CORPINCTX_c, color = "Control Group"), linetype = "dashed") +
# Additional lines from Rev2 dataframe
geom_line(data = Rev2 %>% filter(State_Acronym %in% c("NE", "CO", "RI", "DE", "ND")), aes(x = year, y = Log_CORPINCTX, color = State_Acronym, size = ifelse(State_Acronym %in% c("NE", "CO", "RI", "DE", "ND"), 1.5, 1))) +
# Vertical lines
geom_vline(aes(xintercept = c(1988, 2009, 2015, 2016, 2017)), linetype = "dashed", color = "gray40") +
labs(title = "Average Log Corporate Income Tax by Year for Control Group",
x = "Year",
y = "Average Log Corporate Income Tax") +
scale_color_manual(values = c("Control Group" = "blue", "NE" = "red", "CO" = "green", "RI" = "purple", "DE" = "orange", "ND" = "brown"),
labels = c("Control Group" = "Control", "NE" = "NE", "CO" = "CO", "RI" = "RI", "DE" = "DE", "ND" = "ND")) +
scale_size_manual(values = c("1.5", "1"),
breaks = c("1.5", "1"),
labels = c("CO = 2009, DE = 2017, NE=1988, RI = 2015, ND = 2016")) +
guides(color = guide_legend(title = "Groups", override.aes = list(size = c(3, 3, 3, 3, 3, 1.5),
linetype = c("dashed", "solid", "solid", "solid", "solid", "solid"),
color = c("blue", "red", "green", "purple", "orange", "brown")),
labels = c("Control", "NE", "CO", "RI", "DE", "ND"))) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold")
)
#Attempt with Vertical Lines
ggplot() +
# Control Group plot
geom_point(data = Diff_rev, aes(x = year, y = average_Log_CORPINCTX_c, color = "Control Group"), size = 3) +
geom_errorbar(data = Diff_rev, aes(x = year, y = average_Log_CORPINCTX_c, ymin = average_Log_CORPINCTX_c - std_err_c, ymax = average_Log_CORPINCTX_c + std_err_c, color = "Control Group"), width = 0.2) +
geom_line(data = Diff_rev, aes(x = year, y = average_Log_CORPINCTX_c, color = "Control Group"), linetype = "dashed") +
# Additional lines from Rev2 dataframe
geom_line(data = Rev2 %>% filter(State_Acronym %in% c("NE", "CO", "RI", "DE", "ND")), aes(x = year, y = Log_CORPINCTX, color = State_Acronym, size = ifelse(State_Acronym %in% c("NE", "CO", "RI", "DE", "ND"), 1.5, 1))) +
# Vertical lines
geom_vline(aes(xintercept = c(1988, 2009, 2015, 2016, 2017)), linetype = "dashed", color = "gray40") +
labs(title = "Average Log Corporate Income Tax by Year for Control Group",
x = "Year",
y = "Average Log Corporate Income Tax") +
scale_color_manual(values = c("Control Group" = "blue", "NE" = "red", "CO" = "green", "RI" = "purple", "DE" = "orange", "ND" = "brown"),
labels = c("Control Group" = "Control", "NE" = "NE", "CO" = "CO", "RI" = "RI", "DE" = "DE", "ND" = "ND")) +
scale_size_manual(values = c("1" = 1, "1.5" = 1.5),
labels = c("1.5" = "CO = 2009, DE = 2017, NE=1988, RI = 2015, ND = 2016")) +
guides(color = guide_legend(title = "Groups", override.aes = list(size = c(3, 3, 3, 3, 3, 1.5),
linetype = c("dashed", "solid", "solid", "solid", "solid", "solid"),
color = c("blue", "red", "green", "purple", "orange", "brown")),
labels = c("Control", "NE", "CO", "RI", "DE", "ND"))) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold")
)
#Attempt with Vertical Lines
# Create the plot with Standard Error Bars
ggplot() +
# Control Group plot
geom_point(data = Diff_rev, aes(x = year, y = average_Log_CORPINCTX_c, color = "Control Group"), size = 3) +
geom_errorbar(data = Diff_rev, aes(x = year, y = average_Log_CORPINCTX_c, ymin = average_Log_CORPINCTX_c - std_err_c, ymax = average_Log_CORPINCTX_c + std_err_c, color = "Control Group"), width = 0.2) +
geom_line(data = Diff_rev, aes(x = year, y = average_Log_CORPINCTX_c, color = "Control Group"), linetype = "dashed") +
# Additional lines from Rev2 dataframe
geom_line(data = Rev2 %>% filter(State_Acronym %in% c("NE", "CO", "RI", "DE", "ND")), aes(x = year, y = Log_CORPINCTX, color = State_Acronym)) +
# Vertical lines
geom_vline(aes(xintercept = c(1988, 2009, 2015, 2016, 2017)), linetype = "dashed", color = "gray40") +
labs(title = "Average Log Corporate Income Tax by Year for Control Group",
x = "Year",
y = "Average Log Corporate Income Tax") +
scale_color_manual(values = c("Control Group" = "blue", "NE" = "red", "CO" = "green", "RI" = "purple", "DE" = "orange", "ND" = "brown"),
labels = c("Control Group" = "Control", "NE" = "NE", "CO" = "CO", "RI" = "RI", "DE" = "DE", "ND" = "ND")) +
scale_size_manual(values = c("NE" = 1, "CO" = 1.5, "RI" = 1, "DE" = 1.5, "ND" = 1.5),
labels = c("CO = 2009, DE = 2017, NE=1988, RI = 2015, ND = 2016")) +
guides(color = guide_legend(title = "Groups", override.aes = list(size = c(3, 1, 1.5, 1, 1.5),
linetype = c("dashed", "solid", "solid", "solid", "solid"),
color = c("blue", "red", "green", "purple", "orange", "brown")),
labels = c("Control", "NE", "CO", "RI", "DE", "ND"))) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold")
)
# Create the plot with Standard Error Bars
ggplot() +
# Control Group plot
geom_point(data = Diff_rev, aes(x = year, y = average_Log_CORPINCTX_c, color = "Control Group"), size = 3) +
geom_errorbar(data = Diff_rev, aes(x = year, y = average_Log_CORPINCTX_c, ymin = average_Log_CORPINCTX_c - std_err_c, ymax = average_Log_CORPINCTX_c + std_err_c, color = "Control Group"), width = 0.2) +
geom_line(data = Diff_rev, aes(x = year, y = average_Log_CORPINCTX_c, color = "Control Group"), linetype = "dashed") +
# Additional lines from Rev2 dataframe
geom_line(data = Rev2 %>% filter(State_Acronym %in% c("NE", "CO", "RI", "DE", "ND")), aes(x = year, y = Log_CORPINCTX, color = State_Acronym)) +
# Vertical lines
geom_vline(aes(xintercept = c(1988, 2009, 2015, 2016, 2017)), linetype = "dashed", color = "gray40") +
labs(title = "Average Log Corporate Income Tax by Year for Control Group",
x = "Year",
y = "Average Log Corporate Income Tax") +
scale_color_manual(values = c("Control Group" = "blue", "NE" = "red", "CO" = "green", "RI" = "purple", "DE" = "orange", "ND" = "brown"),
labels = c("Control Group" = "Control", "NE" = "NE", "CO" = "CO", "RI" = "RI", "DE" = "DE", "ND" = "ND")) +
scale_size_manual(values = c("NE" = 1, "CO" = 1.5, "RI" = 1, "DE" = 1.5, "ND" = 1.5),
labels = c("1" = "NE = 1988, RI = 2015", "1.5" = "CO = 2009, DE = 2017, ND = 2016")) +
guides(color = guide_legend(title = "Groups",
override.aes = list(size = c(3, 1, 1.5, 1, 1.5),
linetype = c("dashed", "solid", "solid", "solid", "solid"),
color = c("blue", "red", "green", "purple", "orange", "brown")),
labels = c("Control", "NE", "CO", "RI", "DE", "ND"))) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold")
)
# Create the plot with Standard Error Bars
ggplot() +
# Control Group plot
geom_point(data = Diff_rev, aes(x = year, y = average_Log_CORPINCTX_c, color = "Control Group"), size = 4) +
geom_errorbar(data = Diff_rev, aes(x = year, y = average_Log_CORPINCTX_c, ymin = average_Log_CORPINCTX_c - std_err_c, ymax = average_Log_CORPINCTX_c + std_err_c, color = "Control Group"), width = 0.2) +
geom_line(data = Diff_rev, aes(x = year, y = average_Log_CORPINCTX_c, color = "Control Group"), linetype = "dashed") +
# Additional lines from Rev2 dataframe
geom_line(data = Rev2 %>% filter(State_Acronym %in% c("NE", "CO", "RI", "DE", "ND")), aes(x = year, y = Log_CORPINCTX, color = State_Acronym)) +
# Vertical lines
geom_vline(aes(xintercept = c(1988, 2009, 2015, 2016, 2017)), linetype = "dashed", color = "gray40") +
labs(title = "Average Log Corporate Income Tax by Year for Control Group",
x = "Year",
y = "Average Log Corporate Income Tax") +
scale_color_manual(values = c("Control Group" = "blue", "NE" = "red", "CO" = "green", "RI" = "purple", "DE" = "orange", "ND" = "brown"),
labels = c("Control Group" = "Control", "NE" = "NE", "CO" = "CO", "RI" = "RI", "DE" = "DE", "ND" = "ND")) +
scale_size_manual(values = c("Control Group" = 4, "NE" = 1, "CO" = 1.5, "RI" = 1, "DE" = 1.5, "ND" = 1.5),
labels = c("4" = "Control", "1" = "NE = 1988, RI = 2015", "1.5" = "CO = 2009, DE = 2017, ND = 2016")) +
guides(color = guide_legend(title = "Groups",
override.aes = list(size = c(4, 1, 1.5, 1, 1.5),
linetype = c("dashed", "solid", "solid", "solid", "solid"),
color = c("blue", "red", "green", "purple", "orange", "brown")),
labels = c("Control", "NE", "CO", "RI", "DE", "ND"))) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold")
)
# Create the plot with Standard Error Bars
ggplot() +
# Control Group plot
geom_point(data = Diff_rev, aes(x = year, y = average_Log_CORPINCTX_c, color = "Control Group"), size = 4) +
geom_errorbar(data = Diff_rev, aes(x = year, y = average_Log_CORPINCTX_c, ymin = average_Log_CORPINCTX_c - std_err_c, ymax = average_Log_CORPINCTX_c + std_err_c, color = "Control Group"), width = 0.2) +
geom_line(data = Diff_rev, aes(x = year, y = average_Log_CORPINCTX_c, color = "Control Group"), linetype = "dashed") +
# Additional lines from Rev2 dataframe
geom_line(data = Rev2 %>% filter(State_Acronym %in% c("NE", "CO", "RI", "DE", "ND")), aes(x = year, y = Log_CORPINCTX, color = State_Acronym)) +
# Vertical lines
geom_vline(aes(xintercept = c(1988, 2009, 2015, 2016, 2017)), linetype = "dashed", color = "gray40") +
labs(title = "Average Log Corporate Income Tax by Year for Control Group",
x = "Year",
y = "Average Log Corporate Income Tax") +
scale_color_manual(values = c("Control Group" = "blue", "NE" = "red", "CO" = "green", "RI" = "purple", "DE" = "orange", "ND" = "brown"),
labels = c("Control Group" = "Control", "NE" = "NE", "CO" = "CO", "RI" = "RI", "DE" = "DE", "ND" = "ND")) +
scale_size_manual(values = c("Control Group" = 4, "NE" = 1, "CO" = 1.5, "RI" = 1, "DE" = 1.5, "ND" = 1.5),
labels = c("4" = "Control", "1" = "NE = 1988, RI = 2015", "1.5" = "CO = 2009, DE = 2017, ND = 2016")) +
guides(color = guide_legend(title = "Groups",
override.aes = list(size = c(4, 1, 1.5, 1, 1.5),
linetype = c("dashed", "solid", "solid", "solid", "solid"),
color = c("blue", "red", "green", "purple", "orange", "brown")),
labels = c("Control", "NE", "CO", "RI", "DE", "ND"))) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold")
)
# Create the plot with Standard Error Bars
ggplot() +
# Control Group plot
geom_point(data = Diff_rev, aes(x = year, y = average_Log_CORPINCTX_c, color = "Control Group"), size = 4) +
geom_errorbar(data = Diff_rev, aes(x = year, y = average_Log_CORPINCTX_c, ymin = average_Log_CORPINCTX_c - std_err_c, ymax = average_Log_CORPINCTX_c + std_err_c, color = "Control Group"), width = 0.2) +
geom_line(data = Diff_rev, aes(x = year, y = average_Log_CORPINCTX_c, color = "Control Group"), linetype = "dashed") +
# Additional lines from Rev2 dataframe
geom_line(data = Rev2 %>% filter(State_Acronym %in% c("NE", "CO", "RI", "DE", "ND")), aes(x = year, y = Log_CORPINCTX, color = State_Acronym)) +
# Vertical lines
geom_vline(aes(xintercept = c(1988, 2009, 2015, 2016, 2017)), linetype = "dashed", color = "gray40") +
labs(title = "Average Log Corporate Income Tax by Year for Control Group",
x = "Year",
y = "Average Log Corporate Income Tax") +
scale_color_manual(values = c("Control Group" = "blue", "NE" = "red", "CO" = "green", "RI" = "purple", "DE" = "orange", "ND" = "brown"),
labels = c("Control Group" = "Control", "NE" = "NE", "CO" = "CO", "RI" = "RI", "DE" = "DE", "ND" = "ND")) +
scale_size_manual(values = c("Control Group" = 4, "NE" = 1, "CO" = 1.5, "RI" = 1, "DE" = 1.5, "ND" = 1.5),
labels = c("4" = "Control", "1" = "NE = 1988, RI = 2015", "1.5" = "CO = 2009, DE = 2017, ND = 2016")) +
guides(color = guide_legend(title = "Groups",
override.aes = list(size = c(4, 1, 1.5, 1, 1.5),
linetype = c("dashed", "solid", "solid", "solid", "solid"),
color = c("blue", "red", "green", "purple", "orange", "brown")),
labels = c("Control", "NE", "CO", "RI", "DE", "ND"))) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold")
)
# Create the plot with Standard Error Bars
ggplot() +
# Control Group plot
geom_point(data = Diff_rev, aes(x = year, y = average_Log_CORPINCTX_c, color = "Control Group"), size = 4) +
geom_errorbar(data = Diff_rev, aes(x = year, y = average_Log_CORPINCTX_c, ymin = average_Log_CORPINCTX_c - std_err_c, ymax = average_Log_CORPINCTX_c + std_err_c, color = "Control Group"), width = 0.2) +
geom_line(data = Diff_rev, aes(x = year, y = average_Log_CORPINCTX_c, color = "Control Group"), linetype = "dashed") +
# Additional lines from Rev2 dataframe
geom_line(data = Rev2 %>% filter(State_Acronym %in% c("NE", "CO", "RI", "DE", "ND")), aes(x = year, y = Log_CORPINCTX, color = State_Acronym)) +
# Vertical lines
geom_vline(aes(xintercept = c(1988, 2009, 2015, 2016, 2017)), linetype = "dashed", color = "gray40") +
labs(title = "Average Log Corporate Income Tax by Year for Control Group",
x = "Year",
y = "Average Log Corporate Income Tax") +
scale_color_manual(values = c("Control Group" = "blue", "NE" = "red", "CO" = "green", "RI" = "purple", "DE" = "orange", "ND" = "brown"),
labels = c("Control Group" = "Control", "NE" = "NE", "CO" = "CO", "RI" = "RI", "DE" = "DE", "ND" = "ND")) +
scale_size_manual(values = c("Control Group" = 4, "NE" = 1, "CO" = 1.5, "RI" = 1, "DE" = 1.5, "ND" = 1.5),
labels = c("4" = "Control", "1" = "NE = 1988, RI = 2015", "1.5" = "CO = 2009, DE = 2017, ND = 2016")) +
guides(color = guide_legend(title = "Groups",
override.aes = list(size = c(4, 1, 1.5, 1, 1.5),
linetype = c("dashed", "solid", "solid", "solid", "solid"),
color = c("blue", "red", "green", "purple", "orange", "brown")),
labels = c("Control", "NE", "CO", "RI", "DE", "ND"))) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold")
)
#Attempt with Vertical Lines
ggplot() +
# Control Group plot
geom_point(data = Diff_rev, aes(x = year, y = average_Log_CORPINCTX_c, color = "Control Group"), size = 4) +
geom_errorbar(data = Diff_rev, aes(x = year, y = average_Log_CORPINCTX_c, ymin = average_Log_CORPINCTX_c - std_err_c, ymax = average_Log_CORPINCTX_c + std_err_c, color = "Control Group"), width = 0.2) +
geom_line(data = Diff_rev, aes(x = year, y = average_Log_CORPINCTX_c, color = "Control Group"), linetype = "dashed") +
# Additional lines from Rev2 dataframe
geom_line(data = Rev2 %>% filter(State_Acronym %in% c("NE", "CO", "RI", "DE", "ND")), aes(x = year, y = Log_CORPINCTX, color = State_Acronym)) +
# Vertical lines
geom_vline(aes(xintercept = c(1988, 2009, 2015, 2016, 2017)), linetype = "dashed", color = "gray40") +
labs(title = "Average Log Corporate Income Tax by Year for Control Group",
x = "Year",
y = "Average Log Corporate Income Tax") +
scale_color_manual(values = c("Control Group" = "blue", "NE" = "red", "CO" = "green", "RI" = "purple", "DE" = "orange", "ND" = "brown"),
labels = c("Control Group" = "Control", "NE" = "NE", "CO" = "CO", "RI" = "RI", "DE" = "DE", "ND" = "ND")) +
scale_size_manual(values = c("Control Group" = 4, "NE" = 1, "CO" = 1.5, "RI" = 1, "DE" = 1.5, "ND" = 1.5),
labels = c("4" = "Control", "1" = "NE = 1988, RI = 2015", "1.5" = "CO = 2009, DE = 2017, ND = 2016")) +
guides(color = guide_legend(title = "Groups",
override.aes = list(size = c(4, 1, 1.5, 1, 1.5,1.5),
linetype = c("dashed", "solid", "solid", "solid", "solid","solid"),
color = c("blue", "red", "green", "purple", "orange", "brown")),
labels = c("Control", "NE", "CO", "RI", "DE", "ND"))) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold")
)
# Create the plot with Standard Error Bars
ggplot() +
# Control Group plot
geom_point(data = Diff_rev, aes(x = year, y = average_Log_CORPINCTX_c, color = "Control Group"), size = 4) +
geom_errorbar(data = Diff_rev, aes(x = year, y = average_Log_CORPINCTX_c, ymin = average_Log_CORPINCTX_c - std_err_c, ymax = average_Log_CORPINCTX_c + std_err_c, color = "Control Group"), width = 0.2) +
geom_line(data = Diff_rev, aes(x = year, y = average_Log_CORPINCTX_c, color = "Control Group"), linetype = "dashed") +
# Additional lines from Rev2 dataframe
geom_line(data = Rev2 %>% filter(State_Acronym %in% c("NE", "CO", "RI", "DE", "ND")), aes(x = year, y = Log_CORPINCTX, color = State_Acronym)) +
# Vertical lines
geom_vline(aes(xintercept = c(1988, 2009, 2015, 2016, 2017)), linetype = "dashed", color = "gray40") +
labs(title = "Average Log Corporate Income Tax by Year for Control Group",
x = "Year",
y = "Average Log Corporate Income Tax") +
scale_color_manual(values = c("Control Group" = "blue", "CO" = "red", "NE" = "green", "RI" = "purple", "DE" = "orange", "ND" = "brown"),
labels = c("Control Group" = "CO", "CO" = "Control", "NE" = "NE", "RI" = "RI", "DE" = "DE", "ND" = "ND")) +
scale_size_manual(values = c("Control Group" = 4, "NE" = 1, "CO" = 1.5, "RI" = 1, "DE" = 1.5, "ND" = 1.5),
labels = c("4" = "Control", "1" = "NE = 1988, RI = 2015", "1.5" = "CO = 2009, DE = 2017, ND = 2016")) +
guides(color = guide_legend(title = "Groups",
override.aes = list(size = c(4, 1, 1.5, 1, 1.5, 1.5),
linetype = c("dashed", "solid", "solid", "solid", "solid", "solid"),
color = c("blue", "red", "green", "purple", "orange", "brown")),
labels = c("CO", "Control", "NE", "RI", "DE", "ND"))) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold")
)
